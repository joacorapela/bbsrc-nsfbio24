\subsubsubsection{Real-Time Machine Learning in Neuroscience}

Real-time machine learning (RTML) is widely used across sectors such as finance, logistics, and environmental monitoring.
%
For instance, in climate science, RTML enables real-time wildfire and flood detection from satellite data, as well as the forecasting of extreme weather events using streaming radar and sensor signals.
%
In food delivery systems, RTML is used to estimate delivery times based on traffic, kitchen queue lengths, and historical performance, and to dynamically optimize dispatching routes.

Surprisingly, RTML is still underutilized in neuroscience.
%
This represents a missed opportunity—particularly in the context of naturalistic, long-duration, and continual (NaLoDuCo) experimentation—where adaptive, low-latency computation could significantly enhance both experimental control and analysis.

\paragraph{Real-Time Experimental Design Verification.}
In traditional neuroscience workflows, analysis is done offline, often days or weeks after data collection.
%
Errors or design flaws are only discovered post hoc, sometimes necessitating a costly repetition of experiments.
%
This problem is exacerbated in NaLoDuCo settings, where experiments may last weeks or months.
%
RTML can address this by providing online assessments of experiment progress and data quality, allowing early detection of issues and in-situ protocol adjustments.

\paragraph{Intelligent Neuromodulation.}
Neuromodulation can be performed optically, chemically, or electrically.
%
Typically, stimulation is delivered at pre-defined times or based on simple thresholds in neural or behavioral signals.
%
With RTML, these interventions can be driven by more sophisticated models that infer high-level internal states from ongoing data.

%
For example, a scientist may hypothesize that a peak in a latent neural variable—estimated in real time from a prefrontal cortex population—signals the onset of a foraging decision.
%
To test this, she uses an online latent variable model to forecast the peak's occurrence and triggers optogenetic inactivation just before the predicted moment.
%
If the intervention disrupts foraging onset, this provides causal support for the hypothesis.

\paragraph{Intelligent Data Storage.}
As the richness and duration of NaLoDuCo experiments increase, storing all raw data becomes infeasible.
%
We will need RTML algorithms to make real-time decisions about what data to retain and what to discard.

%
For example, consider a setup with ten high-resolution cameras monitoring a mouse in a large arena.
%
Storing all video streams continuously is inefficient.
%
Instead, a tracking model can estimate the animal's location in real time.
%
When the confidence of the tracker is high, only the streams from relevant cameras are saved.
%
When uncertainty is high, more data can be preserved for later inspection.

\subsubsubsection{Bonsai and Bonsai.ML}

Bonsai is a widely adopted open-source software ecosystem for experimental control in neuroscience~\citep{lopesEtAl15}.
%
With support from the
\href{https://gow.bbsrc.ukri.org/grants/AwardDetails.aspx?FundingReference=BB\%2FW019132\%2F1}{BBSRC},
we are developing software infrastructure to enable intelligent experimentation through the
\href{https://bonsai-rx.org/machinelearning/}{Bonsai.ML} package.

%
We have already integrated several real-time ML models into Bonsai.ML, including linear regression, linear dynamical systems, hidden Markov models, and Bayesian point-process decoders.
%
In collaboration with researchers at SWC and UCL, we have applied these tools to real-time inference of visual receptive fields, foraging kinematics, behavioral state classification, and spatial decoding from hippocampal spiking activity.

%
However, existing Bonsai.ML methods assume stationarity, which—as discussed in Section~\ref{sec:offlineAnalysisMethods}—is inappropriate for NaLoDuCo data.
%
We will adapt these methods to operate under non-stationary conditions using techniques outlined in Section~\ref{sec:non-stationarity}.

%
All new RTML methods for non-stationary experimental control will be released as open-source extensions to the
\href{https://bonsai-rx.org/machinelearning/}{Bonsai.ML} library.

%
At SWC and AIND, where Bonsai is used for experimental control, we will collaborate with domain experts to apply these advanced RTML methods to cutting-edge NaLoDuCo experiments in real-world settings.

\subsubsubsection{Deliverables}

\begin{enumerate}
    \item A repository of real-time ML methods for neuroscience experimental control, adapted to handle non-stationary data streams.
    \item Publications co-authored with scientists at SWC and AIND, reporting experimental findings made possible by non-stationary Bonsai.ML methods.
\end{enumerate}

